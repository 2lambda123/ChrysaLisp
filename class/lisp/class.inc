(include 'class/obj/class.inc)
(include 'class/error/class.inc)
(include 'class/vector/class.inc)

(def-class 'lisp 'obj)
(dec-method 'vtable 'class/lisp/vtable)
(dec-method 'create 'class/lisp/create 'static '(r0 r1 r2) '(r0))
(dec-method 'init 'class/lisp/init 'static '(r0 r1 r2 r3 r4))
(dec-method 'deinit 'class/lisp/deinit 'final)

(dec-method 'env_push 'class/lisp/env_push 'static '(r0) '(r0))
(dec-method 'env_pop 'class/lisp/env_pop 'static '(r0) '(r0))
(dec-method 'env_bind 'class/lisp/env_bind 'static '(r0 r1 r2) '(r0 r1))
(dec-method 'env_args_set 'class/lisp/env_args_set 'static '(r0 r1 r2))
(dec-method 'env_args_type1 'class/lisp/env_args_type1 'static '(r1 r3 r4) '(r2))
(dec-method 'env_args_type2 'class/lisp/env_args_type2 'static '(r1 r3 r4) '(r2))
(dec-method 'env_args_type3 'class/lisp/env_args_type3 'static '(r1 r3 r4) '(r2))

(dec-method 'read 'class/lisp/read 'static '(r0 r1 r2) '(r0 r1 r2))
(dec-method 'read_char 'class/lisp/read_char 'static '(r0 r1 r2) '(r0 r1))
(dec-method 'read_rmacro 'class/lisp/read_rmacro 'static '(r0 r1 r2 r3) '(r0 r1 r2))
(dec-method 'read_list 'class/lisp/read_list 'static '(r0 r1 r2) '(r0 r1 r2))
(dec-method 'read_sym 'class/lisp/read_sym 'static '(r0 r1 r2) '(r0 r1 r2))
(dec-method 'read_str 'class/lisp/read_str 'static '(r0 r1 r2) '(r0 r1 r2))
(dec-method 'read_num 'class/lisp/read_num 'static '(r0 r1 r2) '(r0 r1 r2))

(dec-method 'repl_eval 'class/lisp/repl_eval 'static '(r0 r1) '(r0 r1))
(dec-method 'repl_eval_list 'class/lisp/repl_eval_list 'static '(r0 r1) '(r0 r1))
(dec-method 'repl_apply 'class/lisp/repl_apply 'static '(r0 r1 r2) '(r0 r1))
(dec-method 'repl_print 'class/lisp/repl_print 'static '(r0 r1 r2) '(r0))
(dec-method 'repl_expand 'class/lisp/repl_expand 'static '(r0 r1) '(r0))
(dec-method 'repl_error 'class/lisp/repl_error 'static '(r0 r1 r2 r3) '(r0 r1))

(dec-method 'func_ffi 'class/lisp/func_ffi 'static '(r0 r1) '(r0 r1))
(dec-method 'func_bindfun 'class/lisp/func_bindfun 'static '(r0 r1) '(r0 r1))
(dec-method 'func_macroexpand 'class/lisp/func_macroexpand 'static '(r0 r1) '(r0 r1))
(dec-method 'func_lambda 'class/lisp/func_lambda 'static '(r0 r1) '(r0 r1))
(dec-method 'func_quote 'class/lisp/func_quote 'static '(r0 r1) '(r0 r1))
(dec-method 'func_qquote 'class/lisp/func_qquote 'static '(r0 r1) '(r0 r1))
(dec-method 'func_eql 'class/lisp/func_eql 'static '(r0 r1) '(r0 r1))
(dec-method 'func_cond 'class/lisp/func_cond 'static '(r0 r1) '(r0 r1))
(dec-method 'func_progn 'class/lisp/func_progn 'static '(r0 r1) '(r0 r1))
(dec-method 'func_while 'class/lisp/func_while 'static '(r0 r1) '(r0 r1))
(dec-method 'func_print 'class/lisp/func_print 'static '(r0 r1) '(r0 r1))
(dec-method 'func_prin 'class/lisp/func_prin 'static '(r0 r1) '(r0 r1))
(dec-method 'func_copy 'class/lisp/func_copy 'static '(r0 r1) '(r0 r1))
(dec-method 'func_apply 'class/lisp/func_apply 'static '(r0 r1) '(r0 r1))
(dec-method 'func_repl 'class/lisp/func_repl 'static '(r0 r1) '(r0 r1))
(dec-method 'func_eval 'class/lisp/func_eval 'static '(r0 r1) '(r0 r1))
(dec-method 'func_throw 'class/lisp/func_throw 'static '(r0 r1) '(r0 r1))
(dec-method 'func_catch 'class/lisp/func_catch 'static '(r0 r1) '(r0 r1))
(dec-method 'func_bind 'class/lisp/func_bind 'static '(r0 r1) '(r0 r1))
(dec-method 'func_read 'class/lisp/func_read 'static '(r0 r1) '(r0 r1))
(dec-method 'func_type 'class/lisp/func_type 'static '(r0 r1) '(r0 r1))

(dec-method 'run 'class/lisp/run)

(def-struct 'lisp 'obj)
	;this first block of ptrs gets derefed on deinit
	(ptr 'stdin 'stdout 'stderr 'environment 'sym_underscore 'sym_optional
		'sym_rest 'sym_nil 'sym_t 'sym_lambda 'sym_macro 'sym_quote 'sym_qquote
		'sym_unquote 'sym_splicing 'sym_stream_name 'sym_stream_line 'sym_file_includes
		'sym_ffi)
	(ptr 'stack)
	(ulong 'nextsym)
(def-struct-end)
